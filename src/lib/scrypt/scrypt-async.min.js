/*!
 * Fast "async" scrypt implementation in JavaScript.
 * Copyright (c) 2013-2014 Dmitry Chestnykh | BSD License
 * https://github.com/dchest/scrypt-async-js
 */
function scrypt(r,n,t,o,e,u,f,a){"use strict";function h(r){function n(r){for(var n=0,p=r.length;p>=64;){var l,v,g,y,w,d=o,A=e,b=u,m=f,I=a,j=h,x=c,E=s;for(v=0;16>v;v++)g=n+4*v,i[v]=(255&r[g])<<24|(255&r[g+1])<<16|(255&r[g+2])<<8|255&r[g+3];for(v=16;64>v;v++)l=i[v-2],y=(l>>>17|l<<15)^(l>>>19|l<<13)^l>>>10,l=i[v-15],w=(l>>>7|l<<25)^(l>>>18|l<<14)^l>>>3,i[v]=(y+i[v-7]|0)+(w+i[v-16]|0)|0;for(v=0;64>v;v++)y=(((I>>>6|I<<26)^(I>>>11|I<<21)^(I>>>25|I<<7))+(I&j^~I&x)|0)+(E+(t[v]+i[v]|0)|0)|0,w=((d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10))+(d&A^d&b^A&b)|0,E=x,x=j,j=I,I=m+y|0,m=b,b=A,A=d,d=y+w|0;o=o+d|0,e=e+A|0,u=u+b|0,f=f+m|0,a=a+I|0,h=h+j|0,c=c+x|0,s=s+E|0,n+=64,p-=64}}var t=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=1779033703,e=3144134277,u=1013904242,f=2773480762,a=1359893119,h=2600822924,c=528734635,s=1541459225,i=new Array(64);n(r);var p,l=r.length%64,v=r.length/536870912|0,g=r.length<<3,y=56>l?56:120,w=r.slice(r.length-l,r.length);for(w.push(128),p=l+1;y>p;p++)w.push(0);return w.push(v>>>24&255),w.push(v>>>16&255),w.push(v>>>8&255),w.push(v>>>0&255),w.push(g>>>24&255),w.push(g>>>16&255),w.push(g>>>8&255),w.push(g>>>0&255),n(w),[o>>>24&255,o>>>16&255,o>>>8&255,o>>>0&255,e>>>24&255,e>>>16&255,e>>>8&255,e>>>0&255,u>>>24&255,u>>>16&255,u>>>8&255,u>>>0&255,f>>>24&255,f>>>16&255,f>>>8&255,f>>>0&255,a>>>24&255,a>>>16&255,a>>>8&255,a>>>0&255,h>>>24&255,h>>>16&255,h>>>8&255,h>>>0&255,c>>>24&255,c>>>16&255,c>>>8&255,c>>>0&255,s>>>24&255,s>>>16&255,s>>>8&255,s>>>0&255]}function c(r,n,t){function o(){for(var r=u-1;r>=u-4;r--){if(f[r]++,f[r]<=255)return;f[r]=0}}r=r.length<=64?r:h(r);var e,u=64+n.length+4,f=new Array(u),a=new Array(64),c=[];for(e=0;64>e;e++)f[e]=54;for(e=0;e<r.length;e++)f[e]^=r[e];for(e=0;e<n.length;e++)f[64+e]=n[e];for(e=u-4;u>e;e++)f[e]=0;for(e=0;64>e;e++)a[e]=92;for(e=0;e<r.length;e++)a[e]^=r[e];for(;t>=32;)o(),c=c.concat(h(a.concat(h(f)))),t-=32;return t>0&&(o(),c=c.concat(h(a.concat(h(f))).slice(0,t))),c}function s(r,n,t,o){var e,u,f=r[0]^n[t++],a=r[1]^n[t++],h=r[2]^n[t++],c=r[3]^n[t++],s=r[4]^n[t++],i=r[5]^n[t++],p=r[6]^n[t++],l=r[7]^n[t++],v=r[8]^n[t++],g=r[9]^n[t++],y=r[10]^n[t++],w=r[11]^n[t++],d=r[12]^n[t++],A=r[13]^n[t++],b=r[14]^n[t++],m=r[15]^n[t++],I=f,j=a,x=h,E=c,C=s,N=i,T=p,k=l,q=v,z=g,B=y,D=w,F=d,G=A,H=b,J=m;for(u=0;8>u;u+=2)e=I+F,C^=e<<7|e>>>25,e=C+I,q^=e<<9|e>>>23,e=q+C,F^=e<<13|e>>>19,e=F+q,I^=e<<18|e>>>14,e=N+j,z^=e<<7|e>>>25,e=z+N,G^=e<<9|e>>>23,e=G+z,j^=e<<13|e>>>19,e=j+G,N^=e<<18|e>>>14,e=B+T,H^=e<<7|e>>>25,e=H+B,x^=e<<9|e>>>23,e=x+H,T^=e<<13|e>>>19,e=T+x,B^=e<<18|e>>>14,e=J+D,E^=e<<7|e>>>25,e=E+J,k^=e<<9|e>>>23,e=k+E,D^=e<<13|e>>>19,e=D+k,J^=e<<18|e>>>14,e=I+E,j^=e<<7|e>>>25,e=j+I,x^=e<<9|e>>>23,e=x+j,E^=e<<13|e>>>19,e=E+x,I^=e<<18|e>>>14,e=N+C,T^=e<<7|e>>>25,e=T+N,k^=e<<9|e>>>23,e=k+T,C^=e<<13|e>>>19,e=C+k,N^=e<<18|e>>>14,e=B+z,D^=e<<7|e>>>25,e=D+B,q^=e<<9|e>>>23,e=q+D,z^=e<<13|e>>>19,e=z+q,B^=e<<18|e>>>14,e=J+H,F^=e<<7|e>>>25,e=F+J,G^=e<<9|e>>>23,e=G+F,H^=e<<13|e>>>19,e=H+G,J^=e<<18|e>>>14;n[o++]=r[0]=I+f|0,n[o++]=r[1]=j+a|0,n[o++]=r[2]=x+h|0,n[o++]=r[3]=E+c|0,n[o++]=r[4]=C+s|0,n[o++]=r[5]=N+i|0,n[o++]=r[6]=T+p|0,n[o++]=r[7]=k+l|0,n[o++]=r[8]=q+v|0,n[o++]=r[9]=z+g|0,n[o++]=r[10]=B+y|0,n[o++]=r[11]=D+w|0,n[o++]=r[12]=F+d|0,n[o++]=r[13]=G+A|0,n[o++]=r[14]=H+b|0,n[o++]=r[15]=J+m|0}function i(r,n,t,o,e){for(;e--;)r[n++]=t[o++]}function p(r,n,t,o,e){for(;e--;)r[n++]^=t[o++]}function l(r,n,t,o,e){i(r,0,n,t+16*(2*e-1),16);for(var u=0;2*e>u;u+=2)s(r,n,t+16*u,o+8*u),s(r,n,t+16*u+16,o+8*u+16*e)}function v(r,n,t){return r[n+16*(2*t-1)]}function g(r){for(var n=[],t=0;t<r.length;t++){var o=r.charCodeAt(t);128>o?n.push(o):o>127&&2048>o?(n.push(o>>6|192),n.push(63&o|128)):(n.push(o>>12|224),n.push(o>>6&63|128),n.push(64&o|128))}return n}function y(r){for(var n="0123456789abcdef".split(""),t=r.length,o=[],e=0;t>e;e++)o.push(n[r[e]>>>4&15]),o.push(n[r[e]>>>0&15]);return o.join("")}function w(r){for(var n,t,o,e,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),f=r.length,a=[],h=0;f>h;)n=f>h?r[h++]:0,t=f>h?r[h++]:0,o=f>h?r[h++]:0,e=(n<<16)+(t<<8)+o,a.push(u[e>>>18&63]),a.push(u[e>>>12&63]),a.push(u[e>>>6&63]),a.push(u[e>>>0&63]);return f%3>0&&(a[a.length-1]="=",f%3==1&&(a[a.length-2]="=")),a.join("")}function d(){for(var r=0;32*o>r;r++){var n=4*r;x[q+r]=(255&C[n+3])<<24|(255&C[n+2])<<16|(255&C[n+1])<<8|(255&C[n+0])<<0}}function A(r,n){for(var t=r;n>t;t+=2)i(E,32*t*o,x,q,32*o),l(N,x,q,z,o),i(E,32*(t+1)*o,x,z,32*o),l(N,x,z,q,o)}function b(r,n){for(var t=r;n>t;t+=2){var e=v(x,q,o)&k-1;p(x,q,E,32*e*o,32*o),l(N,x,q,z,o),e=v(x,z,o)&k-1,p(x,z,E,32*e*o,32*o),l(N,x,z,q,o)}}function m(){for(var r=0;32*o>r;r++){var n=x[q+r];C[4*r+0]=n>>>0&255,C[4*r+1]=n>>>8&255,C[4*r+2]=n>>>16&255,C[4*r+3]=n>>>24&255}}function I(r,n,t,o,e){!function u(){setTimeout(function(){o(r,n>r+t?r+t:n),r+=t,n>r?u():e()},0)}()}var j=1;if(1>t||t>31)throw new Error("scrypt: logN not be between 1 and 31");var x,E,C,N,T=1<<31>>>0,k=1<<t>>>0;if(o*j>=1<<30||o>T/128/j||o>T/256||k>T/128/o)throw new Error("scrypt: parameters are too large");"string"==typeof r&&(r=g(r)),"string"==typeof n&&(n=g(n)),"undefined"!=typeof Int32Array?(x=new Int32Array(64*o),E=new Int32Array(32*k*o),N=new Int32Array(16)):(x=[],E=[],N=new Array(16)),C=c(r,n,128*j*o);var q=0,z=32*o;u||(u=1e3),d(),I(0,k,2*u,A,function(){I(0,k,2*u,b,function(){m();var n=c(r,C,e);f("base64"==a?w(n):"hex"==a?y(n):n)})})}"undefined"!=typeof module&&(module.exports=scrypt);